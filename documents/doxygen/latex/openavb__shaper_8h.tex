\hypertarget{openavb__shaper_8h}{}\section{lib/avtp\+\_\+pipeline/shaper/openavb\+\_\+shaper.h 파일 참조}
\label{openavb__shaper_8h}\index{lib/avtp\+\_\+pipeline/shaper/openavb\+\_\+shaper.\+h@{lib/avtp\+\_\+pipeline/shaper/openavb\+\_\+shaper.\+h}}
{\ttfamily \#include \char`\"{}openavb\+\_\+types.\+h\char`\"{}}\\*
openavb\+\_\+shaper.\+h에 대한 include 의존 그래프
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h__incl}
\end{center}
\end{figure}
이 그래프는 이 파일을 직/간접적으로 include 하는 파일들을 보여줍니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{함수}
\begin{DoxyCompactItemize}
\item 
\hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{openavb__shaper_8h_acb36ba4121844a739183fa32afb3f84b}{openavb\+Shaper\+Initialize} (const char $\ast$\hyperlink{aaf-talker_8c_ac7b430acaa92a7a26fbcdad47d2efc20}{ifname}, unsigned int shaper\+Port)
\item 
void \hyperlink{openavb__shaper_8h_afa03c51a5d00c1174aaa008a32569261}{openavb\+Shaper\+Finalize} ()
\item 
\hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{openavb__shaper_8h_a2d1da144f0be1027af9691a40d39b425}{openavb\+Shaper\+Daemon\+Available} (void)
\item 
void $\ast$ \hyperlink{openavb__shaper_8h_afdb0bb26fd9dc02680d89778cf6754bc}{openavb\+Shaper\+Handle} (\hyperlink{openavb__types__base__pub_8h_a4d8ccbeaf8ad040d8880e8971fc62752}{S\+R\+Class\+Idx\+\_\+t} sr\+\_\+class, int measurement\+\_\+interval\+\_\+usec, int max\+\_\+frame\+\_\+size\+\_\+bytes, int max\+\_\+frames\+\_\+per\+\_\+interval, const unsigned char $\ast$\hyperlink{structstream__da}{stream\+\_\+da})
\item 
void \hyperlink{openavb__shaper_8h_ad0c77510fb056fadf87517ece3813f75}{openavb\+Shaper\+Release} (void $\ast$\hyperlink{jack__listener_8c_a6c138155d7b3442efd19d0aa3f93e548}{handle})
\end{DoxyCompactItemize}


\subsection{함수 문서화}
\index{openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}!openavb\+Shaper\+Daemon\+Available@{openavb\+Shaper\+Daemon\+Available}}
\index{openavb\+Shaper\+Daemon\+Available@{openavb\+Shaper\+Daemon\+Available}!openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}}
\subsubsection[{\texorpdfstring{openavb\+Shaper\+Daemon\+Available(void)}{openavbShaperDaemonAvailable(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bool} openavb\+Shaper\+Daemon\+Available (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{openavb__shaper_8h_a2d1da144f0be1027af9691a40d39b425}{}\label{openavb__shaper_8h_a2d1da144f0be1027af9691a40d39b425}


openavb\+\_\+endpoint\+\_\+osal\+\_\+shaper.\+c 파일의 299 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
300 \{
301     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_ab2bfc814f0447a6d975e8332be197b85}{AVB\_TRACE\_ENTRY}(AVB\_TRACE\_SHAPER);
302 
303     \textcolor{keywordflow}{if} (!\hyperlink{openavb__endpoint__osal__shaper_8c_a83f52d659d74b62db1c5b9523a79c536}{shaperRunning}) \{
304         \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_a0906ddd9e84cc650a76634fe8ff766d7}{AVB\_TRACE\_EXIT}(AVB\_TRACE\_SHAPER);
305         \textcolor{keywordflow}{return} \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
306     \}
307 
308     \textcolor{comment}{// Wait for the daemon to connect.}
309     \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} == \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a48d8fc76e17f7fba82c825077b1dfd17}{SHAPER\_STATE\_UNKNOWN}) \{
310         \hyperlink{maap__helper__linux_8h_a63121b744a6265fe4bae4963b032ac02}{SLEEP\_MSEC}(50);
311     \}
312 
313     \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} > \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a48d8fc76e17f7fba82c825077b1dfd17}{SHAPER\_STATE\_UNKNOWN} && 
      \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} < \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a9886746a53326a1287440546b6ff4b23}{SHAPER\_STATE\_NOT\_AVAILABLE}) \{
314         \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_a0906ddd9e84cc650a76634fe8ff766d7}{AVB\_TRACE\_EXIT}(AVB\_TRACE\_SHAPER);
315         \textcolor{keywordflow}{return} \hyperlink{maap__log_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
316     \}
317 
318     \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} != \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a9886746a53326a1287440546b6ff4b23}{SHAPER\_STATE\_NOT\_AVAILABLE}) \{
319         \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_a6e7cd550837a0406e98b81a840d10ea9}{AVB\_LOG\_WARNING}(\textcolor{stringliteral}{"Shaper Daemon not available."});
320     \}
321     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_a0906ddd9e84cc650a76634fe8ff766d7}{AVB\_TRACE\_EXIT}(AVB\_TRACE\_SHAPER);
322     \textcolor{keywordflow}{return} \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
323 \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_a2d1da144f0be1027af9691a40d39b425_icgraph}
\end{center}
\end{figure}


\index{openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}!openavb\+Shaper\+Finalize@{openavb\+Shaper\+Finalize}}
\index{openavb\+Shaper\+Finalize@{openavb\+Shaper\+Finalize}!openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}}
\subsubsection[{\texorpdfstring{openavb\+Shaper\+Finalize()}{openavbShaperFinalize()}}]{\setlength{\rightskip}{0pt plus 5cm}void openavb\+Shaper\+Finalize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{openavb__shaper_8h_afa03c51a5d00c1174aaa008a32569261}{}\label{openavb__shaper_8h_afa03c51a5d00c1174aaa008a32569261}


openavb\+\_\+endpoint\+\_\+osal\+\_\+shaper.\+c 파일의 282 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
283 \{
284     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_ab2bfc814f0447a6d975e8332be197b85}{AVB\_TRACE\_ENTRY}(AVB\_TRACE\_SHAPER);
285 
286     \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_a83f52d659d74b62db1c5b9523a79c536}{shaperRunning}) \{
287         \textcolor{comment}{// Stop the SHAPER thread.}
288         \hyperlink{openavb__endpoint__osal__shaper_8c_a83f52d659d74b62db1c5b9523a79c536}{shaperRunning} = \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
289         pthread\_join(\hyperlink{openavb__endpoint__osal__shaper_8c_a011f82517f52aaf16d838c80ad9f2003}{shaperThreadHandle}, \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
290     \}
291 
292     \hyperlink{maap__helper__linux_8h_aee93da9d4ea28eeaa9c64bd938d5549b}{MUTEX\_CREATE\_ERR}();
293     \hyperlink{maap__helper__linux_8h_afd8d054f881b4a58d1b3b8942b37f04c}{MUTEX\_DESTROY}(shaperMutex);
294     \hyperlink{maap__helper__linux_8h_a08d33bd2184e24e7676bda0efb5a3e5e}{MUTEX\_LOG\_ERR}(\textcolor{stringliteral}{"Error destroying mutex"});
295 
296     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_a0906ddd9e84cc650a76634fe8ff766d7}{AVB\_TRACE\_EXIT}(AVB\_TRACE\_SHAPER);
297 \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_afa03c51a5d00c1174aaa008a32569261_icgraph}
\end{center}
\end{figure}


\index{openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}!openavb\+Shaper\+Handle@{openavb\+Shaper\+Handle}}
\index{openavb\+Shaper\+Handle@{openavb\+Shaper\+Handle}!openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}}
\subsubsection[{\texorpdfstring{openavb\+Shaper\+Handle(\+S\+R\+Class\+Idx\+\_\+t sr\+\_\+class, int measurement\+\_\+interval\+\_\+usec, int max\+\_\+frame\+\_\+size\+\_\+bytes, int max\+\_\+frames\+\_\+per\+\_\+interval, const unsigned char $\ast$stream\+\_\+da)}{openavbShaperHandle(SRClassIdx_t sr_class, int measurement_interval_usec, int max_frame_size_bytes, int max_frames_per_interval, const unsigned char *stream_da)}}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ openavb\+Shaper\+Handle (
\begin{DoxyParamCaption}
\item[{{\bf S\+R\+Class\+Idx\+\_\+t}}]{sr\+\_\+class, }
\item[{int}]{measurement\+\_\+interval\+\_\+usec, }
\item[{int}]{max\+\_\+frame\+\_\+size\+\_\+bytes, }
\item[{int}]{max\+\_\+frames\+\_\+per\+\_\+interval, }
\item[{const unsigned char $\ast$}]{stream\+\_\+da}
\end{DoxyParamCaption}
)}\hypertarget{openavb__shaper_8h_afdb0bb26fd9dc02680d89778cf6754bc}{}\label{openavb__shaper_8h_afdb0bb26fd9dc02680d89778cf6754bc}


openavb\+\_\+endpoint\+\_\+osal\+\_\+shaper.\+c 파일의 325 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
326 \{
327     \textcolor{comment}{// If the daemon is not available, abort!}
328     \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_a16ece46816348fa6d2c5d0e8b47c0098}{socketfd} == -1 || !\hyperlink{openavb__endpoint__osal__shaper_8c_a2d1da144f0be1027af9691a40d39b425}{openavbShaperDaemonAvailable}())
329     \{
330         \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_ac8495212c30dbf627b5ae3a9f01f4e2a}{AVB\_LOG\_ERROR}(\textcolor{stringliteral}{"Shaper reservation attempted with no daemon available"});
331         \textcolor{keywordflow}{return} \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
332     \}
333 
334     \textcolor{comment}{// Find the first available index.}
335     \textcolor{keywordtype}{int} i;
336     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{openavb__endpoint__osal__shaper_8c_ac658b764ed7cda30e7d4d29ee252836a}{MAX\_SHAPER\_RESERVATIONS}; ++i)
337     \{
338         \textcolor{keywordflow}{if} (!(\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].in\_use))
339         \{
340             \textcolor{keywordflow}{break};
341         \}
342     \}
343     \textcolor{keywordflow}{if} (i >= MAX\_SHAPER\_RESERVATIONS)
344     \{
345         \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_ac8495212c30dbf627b5ae3a9f01f4e2a}{AVB\_LOG\_ERROR}(\textcolor{stringliteral}{"No Shaper reservations are available"});
346         \textcolor{keywordflow}{return} \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
347     \}
348 
349     \textcolor{comment}{// Fill in the information.}
350     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_acd374dc544502235efa3c6533c75820f}{in\_use} = \hyperlink{maap__log_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
351     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_abd9f3cf34e5587f607b96c77560cc374}{sr\_class} = sr\_class;
352     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_a848591ef9ab34f6f2eb816fe385fa4d4}{measurement\_interval} = 
      measurement\_interval\_usec;
353     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_a09c29b0090a82147afdb50ae0013b9c6}{max\_frame\_size} = max\_frame\_size\_bytes;
354     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_aace8d964835e57882addf0f51cb64f86}{max\_frames\_per\_interval} = 
      max\_frames\_per\_interval;
355     memcpy(\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structstream__da}{stream\_da}, stream\_da, 
      \hyperlink{openavb__endpoint__osal__shaper_8c_a9822d89774e0d6ddaa06503950130423}{ETH\_ALEN});
356 
357     \textcolor{comment}{// Send the information to the Shaper daemon.}
358     \textcolor{comment}{// Reserving Bandwidth Example:  -ri eth2 -c A -s 125 -b 74 -f 1 -a ff:ff:ff:ff:ff:11\(\backslash\)n}
359     \textcolor{keywordtype}{char} szCommand[200];
360     sprintf(szCommand, \textcolor{stringliteral}{"-ri %s -c %c -s %u -b %u -f %u -a %02x:%02x:%02x:%02x:%02x:%02x"},
361         \hyperlink{openavb__endpoint__osal__shaper_8c_a16adfecef7f22dcb43bee1ded6fc6944}{interfaceOnly},
362         ( \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].sr\_class == \hyperlink{openavb__types__base__pub_8h_a4d8ccbeaf8ad040d8880e8971fc62752a015950a62a4a997ead901490a42654aa}{SR\_CLASS\_A} ? \textcolor{charliteral}{'A'} : \textcolor{charliteral}{'B'} ),
363         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].measurement\_interval,
364         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].max\_frame\_size,
365         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].max\_frames\_per\_interval,
366         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structstream__da}{stream\_da}[0],
367         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[1],
368         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[2],
369         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[3],
370         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[4],
371         \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[5]);
372     \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_afcf1f0c1d10ae9efe3782eb6cae78355}{AVB\_LOGF\_DEBUG}(\textcolor{stringliteral}{"Sending Shaper command:  %s"}, szCommand);
373     strcat(szCommand, \textcolor{stringliteral}{"\(\backslash\)n"});
374     \textcolor{keywordflow}{if} (send(\hyperlink{openavb__endpoint__osal__shaper_8c_a16ece46816348fa6d2c5d0e8b47c0098}{socketfd}, szCommand, strlen(szCommand), 0) < 0)
375     \{
376         \textcolor{comment}{/* Something went wrong.  Abort! */}
377         \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_a7965828e6f132ce789a962b917519e24}{AVB\_LOGF\_ERROR}(\textcolor{stringliteral}{"Shaper:  Error %d writing to network socket (%s)"}, errno, strerror(
      errno));
378         \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a5bf2789c8ead545cd8f84ff988494442}{SHAPER\_STATE\_ERROR};
379         \textcolor{keywordflow}{return} \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL};
380     \}
381 
382     \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a7b8eae53fcd7eeb79339a1904e48cd56}{SHAPER\_STATE\_ENABLED};
383 
384     \textcolor{comment}{// TODO:  Verify that the command was successful.}
385 
386     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{void} *)(&(\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i]));
387 \}
\end{DoxyCode}


이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_afdb0bb26fd9dc02680d89778cf6754bc_cgraph}
\end{center}
\end{figure}




이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_afdb0bb26fd9dc02680d89778cf6754bc_icgraph}
\end{center}
\end{figure}


\index{openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}!openavb\+Shaper\+Initialize@{openavb\+Shaper\+Initialize}}
\index{openavb\+Shaper\+Initialize@{openavb\+Shaper\+Initialize}!openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}}
\subsubsection[{\texorpdfstring{openavb\+Shaper\+Initialize(const char $\ast$ifname, unsigned int shaper\+Port)}{openavbShaperInitialize(const char *ifname, unsigned int shaperPort)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bool} openavb\+Shaper\+Initialize (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{ifname, }
\item[{unsigned int}]{shaper\+Port}
\end{DoxyParamCaption}
)}\hypertarget{openavb__shaper_8h_acb36ba4121844a739183fa32afb3f84b}{}\label{openavb__shaper_8h_acb36ba4121844a739183fa32afb3f84b}


openavb\+\_\+endpoint\+\_\+osal\+\_\+shaper.\+c 파일의 238 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
239 \{
240     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_ab2bfc814f0447a6d975e8332be197b85}{AVB\_TRACE\_ENTRY}(AVB\_TRACE\_SHAPER);
241 
242     \hyperlink{maap__helper__linux_8h_aa4357bf132bbe882647e5390b6e4c6fd}{MUTEX\_ATTR\_HANDLE}(mta);
243     \hyperlink{maap__helper__linux_8h_a92469004d3cad1f5c2fc61c27377b960}{MUTEX\_ATTR\_INIT}(mta);
244     \hyperlink{maap__helper__linux_8h_aa049f137bcdd27b92f47387f3cb8e800}{MUTEX\_ATTR\_SET\_TYPE}(mta, \hyperlink{maap__helper__linux_8h_ac374e7f6cc426fc8b6b85bbf230232e2}{MUTEX\_ATTR\_TYPE\_DEFAULT});
245     \hyperlink{maap__helper__linux_8h_a910032bc83a960383ec87492342e322b}{MUTEX\_ATTR\_SET\_NAME}(mta, \textcolor{stringliteral}{"shaperMutex"});
246     \hyperlink{maap__helper__linux_8h_aee93da9d4ea28eeaa9c64bd938d5549b}{MUTEX\_CREATE\_ERR}();
247     \hyperlink{maap__helper__linux_8h_a3419f7f7cdfd641b4a638bf2eb4e935c}{MUTEX\_CREATE}(shaperMutex, mta);
248     \hyperlink{maap__helper__linux_8h_a08d33bd2184e24e7676bda0efb5a3e5e}{MUTEX\_LOG\_ERR}(\textcolor{stringliteral}{"Could not create/initialize 'shaperMutex' mutex"});
249 
250     memset(\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}, 0, \textcolor{keyword}{sizeof}(
      \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}));
251 
252     \textcolor{keywordflow}{if} (shaperPort == 0) \{
253         \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a9886746a53326a1287440546b6ff4b23}{SHAPER\_STATE\_NOT\_AVAILABLE};
254     \}
255     \textcolor{keywordflow}{else} \{
256         \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a48d8fc76e17f7fba82c825077b1dfd17}{SHAPER\_STATE\_UNKNOWN};
257         sprintf(\hyperlink{openavb__endpoint__osal__shaper_8c_a918897dbfe631820e6e9beb6122c3a23}{shaperDaemonPort}, \textcolor{stringliteral}{"%u"}, shaperPort);
258 
259         \textcolor{comment}{// Save the interface-only name to pass to the daemon later.}
260         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *ifonly = strchr(\hyperlink{aaf-talker_8c_ac7b430acaa92a7a26fbcdad47d2efc20}{ifname}, \textcolor{charliteral}{':'});
261         \textcolor{keywordflow}{if} (ifonly) \{
262             ifonly++; \textcolor{comment}{// Go past the colon}
263         \} \textcolor{keywordflow}{else} \{
264             ifonly = \hyperlink{aaf-talker_8c_ac7b430acaa92a7a26fbcdad47d2efc20}{ifname}; \textcolor{comment}{// No colon in interface name}
265         \}
266         strncpy(\hyperlink{openavb__endpoint__osal__shaper_8c_a16adfecef7f22dcb43bee1ded6fc6944}{interfaceOnly}, ifonly, \textcolor{keyword}{sizeof}(\hyperlink{openavb__endpoint__osal__shaper_8c_a16adfecef7f22dcb43bee1ded6fc6944}{interfaceOnly}));
267         \hyperlink{openavb__endpoint__osal__shaper_8c_a16adfecef7f22dcb43bee1ded6fc6944}{interfaceOnly}[\textcolor{keyword}{sizeof}(\hyperlink{openavb__endpoint__osal__shaper_8c_a16adfecef7f22dcb43bee1ded6fc6944}{interfaceOnly}) - 1] = \textcolor{charliteral}{'\(\backslash\)0'};
268 
269         \hyperlink{openavb__endpoint__osal__shaper_8c_a83f52d659d74b62db1c5b9523a79c536}{shaperRunning} = \hyperlink{maap__log_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
270         \textcolor{keywordtype}{int} \hyperlink{gst__avb__playbin_8c_a6ce68847c12434f60d1b2654a3dc3409}{err} = pthread\_create(&\hyperlink{openavb__endpoint__osal__shaper_8c_a011f82517f52aaf16d838c80ad9f2003}{shaperThreadHandle}, \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}, 
      \hyperlink{openavb__endpoint__osal__shaper_8c_adadebca3fdb4c4ac1668fa459076614b}{shaperThread}, \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL});
271         \textcolor{keywordflow}{if} (err) \{
272             shaperRunning = \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
273             \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a5bf2789c8ead545cd8f84ff988494442}{SHAPER\_STATE\_ERROR};
274             \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_a7965828e6f132ce789a962b917519e24}{AVB\_LOGF\_ERROR}(\textcolor{stringliteral}{"Failed to start SHAPER thread: %s"}, strerror(err));
275         \}
276     \}
277 
278     \hyperlink{build_2sdk__eavb_2openavb__trace__pub_8h_a0906ddd9e84cc650a76634fe8ff766d7}{AVB\_TRACE\_EXIT}(AVB\_TRACE\_SHAPER);
279     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
280 \}
\end{DoxyCode}


이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{openavb__shaper_8h_acb36ba4121844a739183fa32afb3f84b_cgraph}
\end{center}
\end{figure}




이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_acb36ba4121844a739183fa32afb3f84b_icgraph}
\end{center}
\end{figure}


\index{openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}!openavb\+Shaper\+Release@{openavb\+Shaper\+Release}}
\index{openavb\+Shaper\+Release@{openavb\+Shaper\+Release}!openavb\+\_\+shaper.\+h@{openavb\+\_\+shaper.\+h}}
\subsubsection[{\texorpdfstring{openavb\+Shaper\+Release(void $\ast$handle)}{openavbShaperRelease(void *handle)}}]{\setlength{\rightskip}{0pt plus 5cm}void openavb\+Shaper\+Release (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{handle}
\end{DoxyParamCaption}
)}\hypertarget{openavb__shaper_8h_ad0c77510fb056fadf87517ece3813f75}{}\label{openavb__shaper_8h_ad0c77510fb056fadf87517ece3813f75}


openavb\+\_\+endpoint\+\_\+osal\+\_\+shaper.\+c 파일의 389 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
390 \{
391     \textcolor{keywordtype}{int} i;
392     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{openavb__endpoint__osal__shaper_8c_ac658b764ed7cda30e7d4d29ee252836a}{MAX\_SHAPER\_RESERVATIONS}; ++i)
393     \{
394         \textcolor{keywordflow}{if} (\hyperlink{jack__listener_8c_a6c138155d7b3442efd19d0aa3f93e548}{handle} == (\textcolor{keywordtype}{void} *)(&(\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i])))
395         \{
396             \textcolor{keywordflow}{if} (\hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].in\_use)
397             \{
398                 \textcolor{comment}{// Send the information to the Shaper daemon.}
399                 \textcolor{comment}{// Unreserving Bandwidth Example:  -ua ff:ff:ff:ff:ff:11\(\backslash\)n}
400                 \textcolor{keywordtype}{char} szCommand[200];
401                 sprintf(szCommand, \textcolor{stringliteral}{"-ua %02x:%02x:%02x:%02x:%02x:%02x"},
402                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structstream__da}{stream\_da}[0],
403                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[1],
404                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[2],
405                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[3],
406                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[4],
407                     \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].stream\_da[5]);
408 
409                 \hyperlink{openavb__endpoint__osal__shaper_8c_a4df060aa3b9ca319cb40e39d6590cc43}{shaperReservationList}[i].\hyperlink{structshaper__reservation_acd374dc544502235efa3c6533c75820f}{in\_use} = 
      \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
410 
411                 \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_afcf1f0c1d10ae9efe3782eb6cae78355}{AVB\_LOGF\_DEBUG}(\textcolor{stringliteral}{"Sending Shaper command:  %s"}, szCommand);
412                 strcat(szCommand, \textcolor{stringliteral}{"\(\backslash\)n"});
413                 \textcolor{keywordflow}{if} (send(\hyperlink{openavb__endpoint__osal__shaper_8c_a16ece46816348fa6d2c5d0e8b47c0098}{socketfd}, szCommand, strlen(szCommand), 0) < 0)
414                 \{
415                     \textcolor{comment}{/* Something went wrong. */}
416                     \hyperlink{build_2sdk__eavb_2openavb__log__pub_8h_a7965828e6f132ce789a962b917519e24}{AVB\_LOGF\_ERROR}(\textcolor{stringliteral}{"Shaper:  Error %d writing to network socket (%s)"}, errno,
       strerror(errno));
417                     \hyperlink{openavb__endpoint__osal__shaper_8c_aedad653f274a43dc0eb3b85147fe2c9d}{shaperState} = \hyperlink{openavb__endpoint__osal__shaper_8c_a8cc289c079113479b9b499af4b2ccb21a5bf2789c8ead545cd8f84ff988494442}{SHAPER\_STATE\_ERROR};
418                 \}
419                 \textcolor{keywordflow}{else} \{
420                     \textcolor{comment}{// TODO:  Verify that the command was successful.}
421                 \}
422             \}
423             \textcolor{keywordflow}{break};
424         \}
425     \}
426 \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{openavb__shaper_8h_ad0c77510fb056fadf87517ece3813f75_icgraph}
\end{center}
\end{figure}


