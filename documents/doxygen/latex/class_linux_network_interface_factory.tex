\hypertarget{class_linux_network_interface_factory}{}\section{Linux\+Network\+Interface\+Factory 클래스 참조}
\label{class_linux_network_interface_factory}\index{Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}}


Extends \hyperlink{class_o_s_network_interface_factory}{O\+S\+Network\+Interface\+Factory} for \hyperlink{class_linux_network_interface}{Linux\+Network\+Interface}.  




{\ttfamily \#include $<$linux\+\_\+hal\+\_\+common.\+hpp$>$}



Linux\+Network\+Interface\+Factory에 대한 상속 다이어그램 \+: 
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{class_linux_network_interface_factory__inherit__graph}
\end{center}
\end{figure}


Linux\+Network\+Interface\+Factory에 대한 협력 다이어그램\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{class_linux_network_interface_factory__coll__graph}
\end{center}
\end{figure}
\subsection*{Public 멤버 함수}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{class_linux_network_interface_factory_ad98c21d0fa2f176fa0c8c10ed95f9ab8}{create\+Interface} (\hyperlink{class_o_s_network_interface}{O\+S\+Network\+Interface} $\ast$$\ast$net\+\_\+iface, \hyperlink{class_interface_label}{Interface\+Label} $\ast$label, \hyperlink{class_common_timestamper}{Common\+Timestamper} $\ast$timestamper)
\begin{DoxyCompactList}\small\item\em Creates a new interface. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{정적 Public 멤버 함수}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{class_o_s_network_interface_factory_a31c35b66fcf0061135c152be8e602acd}{register\+Factory} (\hyperlink{classfactory__name__t}{factory\+\_\+name\+\_\+t} id, \hyperlink{class_o_s_network_interface_factory}{O\+S\+Network\+Interface\+Factory} $\ast$factory)
\begin{DoxyCompactList}\small\item\em Registers network factory. \end{DoxyCompactList}\item 
static \hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{class_o_s_network_interface_factory_a459ade6d7c1a3b8688bb8f982805077d}{build\+Interface} (\hyperlink{class_o_s_network_interface}{O\+S\+Network\+Interface} $\ast$$\ast$iface, \hyperlink{classfactory__name__t}{factory\+\_\+name\+\_\+t} id, \hyperlink{class_interface_label}{Interface\+Label} $\ast$iflabel, \hyperlink{class_common_timestamper}{Common\+Timestamper} $\ast$timestamper)
\begin{DoxyCompactList}\small\item\em Builds the network interface. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{상세한 설명}
Extends \hyperlink{class_o_s_network_interface_factory}{O\+S\+Network\+Interface\+Factory} for \hyperlink{class_linux_network_interface}{Linux\+Network\+Interface}. 

linux\+\_\+hal\+\_\+common.\+hpp 파일의 576 번째 라인에서 정의되었습니다.



\subsection{멤버 함수 문서화}
\index{Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}!build\+Interface@{build\+Interface}}
\index{build\+Interface@{build\+Interface}!Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}}
\subsubsection[{\texorpdfstring{build\+Interface(\+O\+S\+Network\+Interface $\ast$$\ast$iface, factory\+\_\+name\+\_\+t id, Interface\+Label $\ast$iflabel, Common\+Timestamper $\ast$timestamper)}{buildInterface(OSNetworkInterface **iface, factory_name_t id, InterfaceLabel *iflabel, CommonTimestamper *timestamper)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf bool} build\+Interface (
\begin{DoxyParamCaption}
\item[{{\bf O\+S\+Network\+Interface} $\ast$$\ast$}]{iface, }
\item[{{\bf factory\+\_\+name\+\_\+t}}]{id, }
\item[{{\bf Interface\+Label} $\ast$}]{iflabel, }
\item[{{\bf Common\+Timestamper} $\ast$}]{timestamper}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [inherited]}}\hypertarget{class_o_s_network_interface_factory_a459ade6d7c1a3b8688bb8f982805077d}{}\label{class_o_s_network_interface_factory_a459ade6d7c1a3b8688bb8f982805077d}


Builds the network interface. 


\begin{DoxyParams}{매개변수}
{\em iface} & \mbox{[}out\mbox{]} Pointer to interface name \\
\hline
{\em id} & Factory name index \\
\hline
{\em iflabel} & Interface label \\
\hline
{\em timestamper} & \hyperlink{class_common_timestamper}{Common\+Timestamper} class pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
T\+R\+UE ok, F\+A\+L\+SE error. 
\end{DoxyReturn}


avbts\+\_\+osnet.\+hpp 파일의 381 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
382                                       \{
383         \textcolor{keywordflow}{return} \hyperlink{class_o_s_network_interface_factory_a60237a7c73ac326584618193523c9350}{factoryMap}[id]->createInterface
384             (iface, iflabel, timestamper);
385     \}
\end{DoxyCode}


이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=273pt]{class_o_s_network_interface_factory_a459ade6d7c1a3b8688bb8f982805077d_cgraph}
\end{center}
\end{figure}




이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_o_s_network_interface_factory_a459ade6d7c1a3b8688bb8f982805077d_icgraph}
\end{center}
\end{figure}


\index{Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}!create\+Interface@{create\+Interface}}
\index{create\+Interface@{create\+Interface}!Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}}
\subsubsection[{\texorpdfstring{create\+Interface(\+O\+S\+Network\+Interface $\ast$$\ast$net\+\_\+iface, Interface\+Label $\ast$label, Common\+Timestamper $\ast$timestamper)}{createInterface(OSNetworkInterface **net_iface, InterfaceLabel *label, CommonTimestamper *timestamper)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bool} create\+Interface (
\begin{DoxyParamCaption}
\item[{{\bf O\+S\+Network\+Interface} $\ast$$\ast$}]{net\+\_\+iface, }
\item[{{\bf Interface\+Label} $\ast$}]{label, }
\item[{{\bf Common\+Timestamper} $\ast$}]{timestamper}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_linux_network_interface_factory_ad98c21d0fa2f176fa0c8c10ed95f9ab8}{}\label{class_linux_network_interface_factory_ad98c21d0fa2f176fa0c8c10ed95f9ab8}


Creates a new interface. 


\begin{DoxyParams}{매개변수}
{\em net\+\_\+iface} & \mbox{[}out\mbox{]} Network interface. Created internally. \\
\hline
{\em label} & \mbox{[}in\mbox{]} Label to be cast to the interface\textquotesingle{}s name internally \\
\hline
{\em timestamper} & \mbox{[}in\mbox{]} Pointer to a hardware timestamp object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
T\+R\+UE if no error during interface creation, F\+A\+L\+SE otherwise 
\end{DoxyReturn}


\hyperlink{class_o_s_network_interface_factory_a13f4010bc12d8b5d7cbaf71d4328b8df}{O\+S\+Network\+Interface\+Factory}를 구현.



linux\+\_\+hal\+\_\+common.\+cpp 파일의 1023 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
1024                                    \{
1025     \textcolor{keyword}{struct }ifreq device;
1026     \textcolor{keywordtype}{int} \hyperlink{gst__avb__playbin_8c_a6ce68847c12434f60d1b2654a3dc3409}{err};
1027     \textcolor{keyword}{struct }sockaddr\_ll \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr};
1028     \textcolor{keyword}{struct }packet\_mreq mr\_8021as;
1029     \hyperlink{class_link_layer_address}{LinkLayerAddress} addr;
1030     \textcolor{keywordtype}{int} ifindex;
1031 
1032     \hyperlink{class_linux_network_interface}{LinuxNetworkInterface} *net\_iface\_l = \textcolor{keyword}{new} 
      \hyperlink{class_linux_network_interface}{LinuxNetworkInterface}();
1033 
1034     \textcolor{keywordflow}{if}( !net\_iface\_l->\hyperlink{class_linux_network_interface_a2485d8ad81138164119a9e8b68642a1d}{net\_lock}.\hyperlink{class_ticketing_lock_aee8048628ff2b5c026c9e15acdcaacb8}{init}()) \{
1035         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"Failed to initialize network lock"});
1036         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1037     \}
1038 
1039     \hyperlink{class_interface_name}{InterfaceName} *\hyperlink{aaf-talker_8c_ac7b430acaa92a7a26fbcdad47d2efc20}{ifname} = \textcolor{keyword}{dynamic\_cast<}\hyperlink{class_interface_name}{InterfaceName} *\textcolor{keyword}{>}(label);
1040     \textcolor{keywordflow}{if}( ifname == \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL} )\{
1041         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"ifname == NULL"});
1042         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1043     \}
1044 
1045     net\_iface\_l->\hyperlink{class_linux_network_interface_a4dac986db2725a7381738a799374da65}{sd\_general} = socket( PF\_PACKET, SOCK\_DGRAM, 0 );
1046     \textcolor{keywordflow}{if}( net\_iface\_l->\hyperlink{class_linux_network_interface_a4dac986db2725a7381738a799374da65}{sd\_general} == -1 ) \{
1047         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"failed to open general socket: %s"}, strerror(errno));
1048         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1049     \}
1050     net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event} = socket( PF\_PACKET, SOCK\_DGRAM, 0 );
1051     \textcolor{keywordflow}{if}( net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event} == -1 ) \{
1052         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}
1053             ( \textcolor{stringliteral}{"failed to open event socket: %s "}, strerror(errno));
1054         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1055     \}
1056 
1057     memset( &device, 0, \textcolor{keyword}{sizeof}(device));
1058     ifname->\hyperlink{class_interface_name_a92a0be2fe51f7da8a6073637d8b7c518}{toString}( device.ifr\_name, \hyperlink{openavb__avdecc__pub_8h_acd06da230a96d3b7e6f193c5b3142002}{IFNAMSIZ} - 1 );
1059     err = ioctl( net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event}, SIOCGIFHWADDR, &device );
1060     \textcolor{keywordflow}{if}( err == -1 ) \{
1061         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}
1062             ( \textcolor{stringliteral}{"Failed to get interface address: %s"}, strerror( errno ));
1063         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1064     \}
1065 
1066     addr = \hyperlink{class_link_layer_address}{LinkLayerAddress}( (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\_t} *)&device.ifr\_hwaddr.sa\_data );
1067     net\_iface\_l->\hyperlink{class_linux_network_interface_af3d1546f688fbb9cec0317d152cab1da}{local\_addr} = addr;
1068     err = ioctl( net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event}, SIOCGIFINDEX, &device );
1069     \textcolor{keywordflow}{if}( err == -1 ) \{
1070         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}
1071             ( \textcolor{stringliteral}{"Failed to get interface index: %s"}, strerror( errno ));
1072         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1073     \}
1074     ifindex = device.ifr\_ifindex;
1075     net\_iface\_l->\hyperlink{class_linux_network_interface_a01e636f8746c84f1cf3d45c4afbfde35}{ifindex} = ifindex;
1076     memset( &mr\_8021as, 0, \textcolor{keyword}{sizeof}( mr\_8021as ));
1077     mr\_8021as.mr\_ifindex = ifindex;
1078     mr\_8021as.mr\_type = PACKET\_MR\_MULTICAST;
1079     mr\_8021as.mr\_alen = 6;
1080     memcpy( mr\_8021as.mr\_address, \hyperlink{linux__hal__common_8hpp_a10940df49c9c0cbf6ab33c8bf858c3b6}{P8021AS\_MULTICAST}, mr\_8021as.mr\_alen );
1081     err = setsockopt
1082         ( net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event}, SOL\_PACKET, PACKET\_ADD\_MEMBERSHIP,
1083           &mr\_8021as, \textcolor{keyword}{sizeof}( mr\_8021as ));
1084     \textcolor{keywordflow}{if}( err == -1 ) \{
1085         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}
1086             ( \textcolor{stringliteral}{"Unable to add PTP multicast addresses to port id: %u"},
1087               ifindex );
1088         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1089     \}
1090 
1091     memset( &\hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr}, 0, \textcolor{keyword}{sizeof}( \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr} ));
1092     \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr}.sll\_family = AF\_PACKET;
1093     \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr}.sll\_ifindex = ifindex;
1094     \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr}.sll\_protocol = \hyperlink{linux_2src_2platform_8cpp_aa89fc0aa7465274c200da69771d2a043}{PLAT\_htons}( \hyperlink{ptptypes_8hpp_a66b4264d8a3f30b62462917df20c3593}{PTP\_ETHERTYPE} );
1095     err = bind
1096         ( net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event}, (sockaddr *) &\hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr},
1097           \textcolor{keyword}{sizeof}( \hyperlink{gst__avb__playbin_8c_af0b4c4a7922dea9c701e7f3a813467e6}{ifsock\_addr} ));
1098     \textcolor{keywordflow}{if}( err == -1 ) \{
1099         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"Call to bind() failed: %s"}, strerror(errno) );
1100         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1101     \}
1102 
1103     net\_iface\_l->\hyperlink{class_linux_network_interface_a47975f2b80d6d5e6fc426813df74feeb}{timestamper} =
1104         dynamic\_cast <\hyperlink{class_linux_timestamper}{LinuxTimestamper} *>(timestamper);
1105     \textcolor{keywordflow}{if}(net\_iface\_l->\hyperlink{class_linux_network_interface_a47975f2b80d6d5e6fc426813df74feeb}{timestamper} == \hyperlink{openavb__types__base__pub_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}) \{
1106         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"timestamper == NULL"} );
1107         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1108     \}
1109     \textcolor{keywordflow}{if}( !net\_iface\_l->\hyperlink{class_linux_network_interface_a47975f2b80d6d5e6fc426813df74feeb}{timestamper}->\hyperlink{class_linux_timestamper_ac2055edb1eebef8381ef57e01f55d3e0}{post\_init}
1110         ( ifindex, net\_iface\_l->\hyperlink{class_linux_network_interface_ab2e41169dafb40e1ab917422a2d1145a}{sd\_event}, &net\_iface\_l->\hyperlink{class_linux_network_interface_a2485d8ad81138164119a9e8b68642a1d}{net\_lock} )) \{
1111         \hyperlink{gptp__log_8hpp_afefbb1009717c128012bfeed94842987}{GPTP\_LOG\_ERROR}( \textcolor{stringliteral}{"post\_init failed\(\backslash\)n"} );
1112         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
1113     \}
1114     *net\_iface = net\_iface\_l;
1115 
1116     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
1117 \}
\end{DoxyCode}


이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{class_linux_network_interface_factory_ad98c21d0fa2f176fa0c8c10ed95f9ab8_cgraph}
\end{center}
\end{figure}




이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_linux_network_interface_factory_ad98c21d0fa2f176fa0c8c10ed95f9ab8_icgraph}
\end{center}
\end{figure}


\index{Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}!register\+Factory@{register\+Factory}}
\index{register\+Factory@{register\+Factory}!Linux\+Network\+Interface\+Factory@{Linux\+Network\+Interface\+Factory}}
\subsubsection[{\texorpdfstring{register\+Factory(factory\+\_\+name\+\_\+t id, O\+S\+Network\+Interface\+Factory $\ast$factory)}{registerFactory(factory_name_t id, OSNetworkInterfaceFactory *factory)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf bool} register\+Factory (
\begin{DoxyParamCaption}
\item[{{\bf factory\+\_\+name\+\_\+t}}]{id, }
\item[{{\bf O\+S\+Network\+Interface\+Factory} $\ast$}]{factory}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}, {\ttfamily [inherited]}}\hypertarget{class_o_s_network_interface_factory_a31c35b66fcf0061135c152be8e602acd}{}\label{class_o_s_network_interface_factory_a31c35b66fcf0061135c152be8e602acd}


Registers network factory. 


\begin{DoxyParams}{매개변수}
{\em id} & \\
\hline
{\em factory} & Factory name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
T\+R\+UE success, F\+A\+L\+SE when could not register it. 
\end{DoxyReturn}


avbts\+\_\+osnet.\+hpp 파일의 364 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
364                                                              \{
365         FactoryMap\_t::iterator iter = \hyperlink{class_o_s_network_interface_factory_a60237a7c73ac326584618193523c9350}{factoryMap}.find(\textcolor{keywordtype}{id});
366         \textcolor{keywordflow}{if} (iter != \hyperlink{class_o_s_network_interface_factory_a60237a7c73ac326584618193523c9350}{factoryMap}.end())
367             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
368         \hyperlink{class_o_s_network_interface_factory_a60237a7c73ac326584618193523c9350}{factoryMap}[id] = factory;
369         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
370     \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{class_o_s_network_interface_factory_a31c35b66fcf0061135c152be8e602acd_icgraph}
\end{center}
\end{figure}




이 클래스에 대한 문서화 페이지는 다음의 파일들로부터 생성되었습니다.\+:\begin{DoxyCompactItemize}
\item 
daemons/gptp/linux/src/\hyperlink{linux__hal__common_8hpp}{linux\+\_\+hal\+\_\+common.\+hpp}\item 
daemons/gptp/linux/src/\hyperlink{linux__hal__common_8cpp}{linux\+\_\+hal\+\_\+common.\+cpp}\end{DoxyCompactItemize}
