\hypertarget{tsc_8hpp}{}\section{daemons/gptp/windows/daemon\+\_\+cl/tsc.hpp 파일 참조}
\label{tsc_8hpp}\index{daemons/gptp/windows/daemon\+\_\+cl/tsc.\+hpp@{daemons/gptp/windows/daemon\+\_\+cl/tsc.\+hpp}}
{\ttfamily \#include $<$intrin.\+h$>$}\\*
{\ttfamily \#include $<$stdint.\+h$>$}\\*
tsc.\+hpp에 대한 include 의존 그래프
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{tsc_8hpp__incl}
\end{center}
\end{figure}
이 그래프는 이 파일을 직/간접적으로 include 하는 파일들을 보여줍니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tsc_8hpp__dep__incl}
\end{center}
\end{figure}
\subsection*{데이타 구조}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_model_number_system_clock_rate_mapping}{Model\+Number\+System\+Clock\+Rate\+Mapping}
\end{DoxyCompactItemize}
\subsection*{매크로}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}{C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF}~(0x15)
\item 
\#define \hyperlink{tsc_8hpp_a8f923ffc697b4c5f88bee10befa34837}{S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ}~(24000000)
\item 
\#define \hyperlink{tsc_8hpp_ab1280b357d19363aa2fe21d3875f2f8b}{M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN}~(2)
\end{DoxyCompactItemize}
\subsection*{함수}
\begin{DoxyCompactItemize}
\item 
unsigned \+\_\+\+\_\+int64 \hyperlink{tsc_8hpp_ac5e5054685820d7572f9b663f0d7aad6}{P\+L\+A\+T\+\_\+rdtsc} ()
\begin{DoxyCompactList}\small\item\em Gets the processor timestamp. \end{DoxyCompactList}\item 
\hyperlink{parse_8c_a6eb1e68cc391dd753bc8ce896dbb8315}{uint32\+\_\+t} \hyperlink{tsc_8hpp_a22b41718ef039f4e921577a821f20f45}{Find\+Frequency\+By\+Model} (\hyperlink{stdint_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\+\_\+t} model\+\_\+query)
\begin{DoxyCompactList}\small\item\em Gets the system clock frequency using C\+PU model number. \end{DoxyCompactList}\item 
\hyperlink{parse_8c_aec6fcb673ff035718c238c8c9d544c47}{uint64\+\_\+t} \hyperlink{tsc_8hpp_a9da55c09944ef0da0cd43fcd0a5a3ee3}{get\+T\+S\+C\+Frequency} (\hyperlink{avb__gptp_8h_af6a258d8f3ee5206d682d799316314b1}{bool} builtin)
\begin{DoxyCompactList}\small\item\em Gets the T\+SC frequnecy. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{변수}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{struct_model_number_system_clock_rate_mapping}{Model\+Number\+System\+Clock\+Rate\+Mapping} \hyperlink{tsc_8hpp_ac4f568a7f8e83257f88a472cd23947b0}{Model\+Number\+System\+Clock\+Rate\+Map} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{매크로 문서화}
\index{tsc.\+hpp@{tsc.\+hpp}!C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF@{C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF}}
\index{C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF@{C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF}{CLOCK_INFO_CPUID_LEAF}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+L\+O\+C\+K\+\_\+\+I\+N\+F\+O\+\_\+\+C\+P\+U\+I\+D\+\_\+\+L\+E\+AF~(0x15)}\hypertarget{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}{}\label{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}


tsc.\+hpp 파일의 51 번째 라인에서 정의되었습니다.

\index{tsc.\+hpp@{tsc.\+hpp}!M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN@{M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN}}
\index{M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN@{M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN}{MAX_MODEL_LIST_LEN}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+M\+O\+D\+E\+L\+\_\+\+L\+I\+S\+T\+\_\+\+L\+EN~(2)}\hypertarget{tsc_8hpp_ab1280b357d19363aa2fe21d3875f2f8b}{}\label{tsc_8hpp_ab1280b357d19363aa2fe21d3875f2f8b}


tsc.\+hpp 파일의 53 번째 라인에서 정의되었습니다.

\index{tsc.\+hpp@{tsc.\+hpp}!S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ@{S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ}}
\index{S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ@{S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ}{SYSTEM_CLOCK_24MHZ}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+Y\+S\+T\+E\+M\+\_\+\+C\+L\+O\+C\+K\+\_\+24\+M\+HZ~(24000000)}\hypertarget{tsc_8hpp_a8f923ffc697b4c5f88bee10befa34837}{}\label{tsc_8hpp_a8f923ffc697b4c5f88bee10befa34837}


tsc.\+hpp 파일의 52 번째 라인에서 정의되었습니다.



\subsection{함수 문서화}
\index{tsc.\+hpp@{tsc.\+hpp}!Find\+Frequency\+By\+Model@{Find\+Frequency\+By\+Model}}
\index{Find\+Frequency\+By\+Model@{Find\+Frequency\+By\+Model}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{Find\+Frequency\+By\+Model(uint8\+\_\+t model\+\_\+query)}{FindFrequencyByModel(uint8_t model_query)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\+\_\+t} Find\+Frequency\+By\+Model (
\begin{DoxyParamCaption}
\item[{{\bf uint8\+\_\+t}}]{model\+\_\+query}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{tsc_8hpp_a22b41718ef039f4e921577a821f20f45}{}\label{tsc_8hpp_a22b41718ef039f4e921577a821f20f45}


Gets the system clock frequency using C\+PU model number. 


\begin{DoxyParams}{매개변수}
{\em model\+\_\+query} & model number to look up \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
System frequency, or 0 on error 
\end{DoxyReturn}


tsc.\+hpp 파일의 73 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
73                                                           \{
74     \hyperlink{struct_model_number_system_clock_rate_mapping}{ModelNumberSystemClockRateMapping} *map = 
      \hyperlink{tsc_8hpp_ac4f568a7f8e83257f88a472cd23947b0}{ModelNumberSystemClockRateMap};
75     \hyperlink{parse_8c_a6eb1e68cc391dd753bc8ce896dbb8315}{uint32\_t} ret = 0;
76 
77     \textcolor{keywordflow}{while} (map->\hyperlink{struct_model_number_system_clock_rate_mapping_a4ff69d868409c6c16c86cab87ee0a3bf}{clock\_rate} != 0)
78     \{
79         \textcolor{keywordtype}{short} *model = map->\hyperlink{struct_model_number_system_clock_rate_mapping_a6b617b9adf3a5925c8ebeb9765c5685f}{model\_list};
80 
81         \textcolor{keywordflow}{while} (*model != -1)
82         \{
83             \textcolor{keywordflow}{if} (*model == model\_query) \{
84                 ret = map->\hyperlink{struct_model_number_system_clock_rate_mapping_a4ff69d868409c6c16c86cab87ee0a3bf}{clock\_rate};
85                 \textcolor{keywordflow}{break};
86             \}
87             ++model;
88         \}
89         ++map;
90     \}
91 
92     \textcolor{keywordflow}{return} ret;
93 \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tsc_8hpp_a22b41718ef039f4e921577a821f20f45_icgraph}
\end{center}
\end{figure}


\index{tsc.\+hpp@{tsc.\+hpp}!get\+T\+S\+C\+Frequency@{get\+T\+S\+C\+Frequency}}
\index{get\+T\+S\+C\+Frequency@{get\+T\+S\+C\+Frequency}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{get\+T\+S\+C\+Frequency(bool builtin)}{getTSCFrequency(bool builtin)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint64\+\_\+t} get\+T\+S\+C\+Frequency (
\begin{DoxyParamCaption}
\item[{{\bf bool}}]{builtin}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{tsc_8hpp_a9da55c09944ef0da0cd43fcd0a5a3ee3}{}\label{tsc_8hpp_a9da55c09944ef0da0cd43fcd0a5a3ee3}


Gets the T\+SC frequnecy. 


\begin{DoxyParams}{매개변수}
{\em builtin} & whether device is connected to the Intel bus (not P\+C\+IE) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
T\+SC frequency, or 0 on error 
\end{DoxyReturn}


tsc.\+hpp 파일의 101 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
101                                                 \{
102     \textcolor{keywordtype}{int} max\_cpuid\_level;
103     \textcolor{keywordtype}{int} tmp[4];
104     BOOL is\_windows\_10;
105     LARGE\_INTEGER freq;
106 
107     \textcolor{comment}{// Find the max cpuid level, and if possible find clock info}
108     \_\_cpuid(tmp, 0);
109     max\_cpuid\_level = tmp[0];
110     \textcolor{keywordflow}{if} (max\_cpuid\_level >= \hyperlink{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}{CLOCK\_INFO\_CPUID\_LEAF})
111         \_\_cpuid(tmp, \hyperlink{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}{CLOCK\_INFO\_CPUID\_LEAF});
112 
113     \textcolor{comment}{// Determine if the OS is Windows 10 or later.}
114     \{
115         OSVERSIONINFOEXW osvi = \{ \textcolor{keyword}{sizeof}(osvi), 0, 0, 0, 0, \{0\}, 0, 0 \};
116         DWORDLONG        \textcolor{keyword}{const} dwlConditionMask = VerSetConditionMask(0, VER\_MAJORVERSION, 
      VER\_GREATER\_EQUAL);
117         osvi.dwMajorVersion = 10;
118 
119         \textcolor{comment}{// NOTE:  VerifyVersionInfo returns false when called by applications that do not have a
       compatibility manifest for Windows 10,}
120         \textcolor{comment}{//  even when the current operating system version is Windows 10.}
121         is\_windows\_10 = VerifyVersionInfoW(&osvi, VER\_MAJORVERSION, dwlConditionMask) != 
      \hyperlink{maap__log_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
122     \}
123 
124     \textcolor{comment}{// For pre-Win10 on 6th Generation or greater Intel CPUs the raw hardware}
125     \textcolor{comment}{// clock will be returned, *else* use QPC for everything else}
126     \textcolor{comment}{//}
127     \textcolor{comment}{// EAX (tmp[0]) must be >= 1, See Intel SDM 17.15.4 "Invariant Time-keeping"}
128     \textcolor{keywordflow}{if} (!is\_windows\_10 &&
129         max\_cpuid\_level >= \hyperlink{tsc_8hpp_a7941ab4d6df092e12812820cf7780654}{CLOCK\_INFO\_CPUID\_LEAF} &&
130         tmp[0] >= 1 &&
131         builtin )
132     \{
133         SYSTEM\_INFO info;
134 
135         GetSystemInfo(&info);
136 
137         \textcolor{comment}{// Look at processor model (upper byte of revision) number to determine clock rate}
138         \textcolor{keywordflow}{return} \hyperlink{tsc_8hpp_a22b41718ef039f4e921577a821f20f45}{FindFrequencyByModel}(info.wProcessorRevision >> 8);
139     \}
140 
141     \textcolor{keywordflow}{if} (QueryPerformanceFrequency(&freq))
142         \textcolor{keywordflow}{return} freq.QuadPart;
143 
144     \textcolor{keywordflow}{return} 0;
145 \}
\end{DoxyCode}


이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{tsc_8hpp_a9da55c09944ef0da0cd43fcd0a5a3ee3_cgraph}
\end{center}
\end{figure}




이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{tsc_8hpp_a9da55c09944ef0da0cd43fcd0a5a3ee3_icgraph}
\end{center}
\end{figure}


\index{tsc.\+hpp@{tsc.\+hpp}!P\+L\+A\+T\+\_\+rdtsc@{P\+L\+A\+T\+\_\+rdtsc}}
\index{P\+L\+A\+T\+\_\+rdtsc@{P\+L\+A\+T\+\_\+rdtsc}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{P\+L\+A\+T\+\_\+rdtsc()}{PLAT_rdtsc()}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned \+\_\+\+\_\+int64 P\+L\+A\+T\+\_\+rdtsc (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{tsc_8hpp_ac5e5054685820d7572f9b663f0d7aad6}{}\label{tsc_8hpp_ac5e5054685820d7572f9b663f0d7aad6}


Gets the processor timestamp. 

\begin{DoxyReturn}{반환값}
processor timestamp 
\end{DoxyReturn}


tsc.\+hpp 파일의 46 번째 라인에서 정의되었습니다.


\begin{DoxyCode}
47 \{
48     \textcolor{keywordflow}{return} \_\_rdtsc();
49 \}
\end{DoxyCode}


이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{tsc_8hpp_ac5e5054685820d7572f9b663f0d7aad6_icgraph}
\end{center}
\end{figure}




\subsection{변수 문서화}
\index{tsc.\+hpp@{tsc.\+hpp}!Model\+Number\+System\+Clock\+Rate\+Map@{Model\+Number\+System\+Clock\+Rate\+Map}}
\index{Model\+Number\+System\+Clock\+Rate\+Map@{Model\+Number\+System\+Clock\+Rate\+Map}!tsc.\+hpp@{tsc.\+hpp}}
\subsubsection[{\texorpdfstring{Model\+Number\+System\+Clock\+Rate\+Map}{ModelNumberSystemClockRateMap}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Model\+Number\+System\+Clock\+Rate\+Mapping} Model\+Number\+System\+Clock\+Rate\+Map\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{tsc_8hpp_ac4f568a7f8e83257f88a472cd23947b0}{}\label{tsc_8hpp_ac4f568a7f8e83257f88a472cd23947b0}
{\bfseries 초기값\+:}
\begin{DoxyCode}
=
\{
    \{\{ 0x5E, 0x4E, -1 \}, \hyperlink{tsc_8hpp_a8f923ffc697b4c5f88bee10befa34837}{SYSTEM\_CLOCK\_24MHZ} \},
    \{\{ -1 \}, 0 \},
\}
\end{DoxyCode}


tsc.\+hpp 파일의 62 번째 라인에서 정의되었습니다.

